<div class="report-asset">
  <!-- action buttons -->
  <ion-tab-bar class="action-buttons">
    <ion-tab-button *ngIf="workorder.tasks.length === 1">
      <ion-icon name="pencil-outline"></ion-icon>
      Modifier le patrimoine
    </ion-tab-button>
    <ion-tab-button>
      <ion-icon name="aperture-outline"></ion-icon>
      Multi-sélection
    </ion-tab-button>
    <ion-tab-button>
      <ion-icon name="add-outline"></ion-icon>
      Créer un patrimoine
    </ion-tab-button>
    <ion-tab-button *ngIf="hasReportClosed()" class="close-report-button" (click)="onCloseCircuit()">
      <ion-icon name="checkmark-outline"></ion-icon>
      Clôturer le circuit en cours
    </ion-tab-button>
  </ion-tab-bar>


  <div class="asset-list" *ngIf="workorder">
    <ion-item *ngFor="let tsk of workorder.tasks" (mouseenter)="onItemHoverEnter(tsk)"
      (mouseleave)="onItemHoverLeave(tsk)">
      <ion-checkbox aria-label="check" slot="start" mode="md" [indeterminate]="tsk.report?.dateCompletion"
        [checked]="tsk.isSelectedTask" (ionChange)="onSelectTask($event,tsk)"
        [disabled]="(layerSelected ? (tsk.assObjTable !== layerSelected) : false) || tsk.report?.dateCompletion"></ion-checkbox>
      <div style="display: inline-block;">
        <ion-label>
          <ion-label class="ion-no-margin">
            {{getLyrLabel(tsk.assObjTable)}}
          </ion-label>
          <ion-note slot="helperText">
            {{tsk.assObjRef}}
          </ion-note>
        </ion-label>
      </div>
      <ng-container
        *ngIf="!draggableMarker && !editTaskEquipment && (workorder.tasks.length === 1 || !workorder.wkoPlanningStartDate) && !tsk.report?.dateCompletion">
        <ion-button slot="end" fill="clear" (click)="onEditEquipment(tsk)">
          <ion-icon slot="icon-only" name="settings-outline"></ion-icon>
        </ion-button>
      </ng-container>
      <ng-container *ngIf="editTaskEquipment && editTaskEquipment.id === tsk.id">
        <ion-button slot="end" fill="clear" (click)="onValidateChangeEquipment(tsk)">
          <ion-icon slot="icon-only" color="success" name="checkmark-circle-outline"></ion-icon>
        </ion-button>
        <ion-button slot="end" fill="clear" (click)="onRemoveChangeEquipment(tsk)">
          <ion-icon slot="icon-only" color="danger" name="close-circle-outline"></ion-icon>
        </ion-button>
        <ion-button *ngIf="tsk.assObjRef" slot="end" fill="clear" (click)="onXyEquipment(tsk)">
          <ion-icon slot="icon-only" color="secondary" name="pin-sharp" class="strike-through"></ion-icon>
        </ion-button>
      </ng-container>
    </ion-item>
  </div>
</div>

