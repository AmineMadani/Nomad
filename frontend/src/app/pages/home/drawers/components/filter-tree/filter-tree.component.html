<mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="details-tree">
  <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle class="non-children-node">
    <ion-item lines="none">
      <ion-checkbox aria-label="checkbox" class="ion-no-margin" [checked]="node.value" (ionChange)="onCheckboxChange($event, node)"></ion-checkbox>
      <img [src]="node.imgSrc" width="24" height="24" />
      <ion-label>{{ node.name }}</ion-label>
    </ion-item>
  </mat-tree-node>

  <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
    <div class="mat-tree-node">
      <ion-item lines="none">
        <ion-button fill="clear" matTreeNodeToggle><ion-icon
          [name]="treeControl.isExpanded(node) ? 'chevron-down-outline' : 'chevron-forward-outline'"></ion-icon></ion-button>
        <ion-checkbox aria-label="checkbox" class="ion-no-margin" [checked]="descendantsAllSelected(node)" [indeterminate]="descendantsPartiallySelected(node)" (ionChange)="onCheckboxChange($event, node)"></ion-checkbox>
        <img [src]="node.imgSrc" width="24" height="24" />
        <ion-label>{{ node.name }}</ion-label>
      </ion-item>
    </div>

    <div [class.details-tree-invisible]="!treeControl.isExpanded(node)" role="group">
      <ng-container matTreeNodeOutlet></ng-container>
    </div>
  </mat-nested-tree-node>
</mat-tree>